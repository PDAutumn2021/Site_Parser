<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}?{% now 'U' %}" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="shortcut icon" type="image/png" href="{% static 'images/favicon.ico' %}"/>
    <title>{% block title %}{% endblock %}</title>
</head>

<body>
    <!-- Шапка с bootstrap -->
    <header class="p-3 bg-dark text-white">
        <a href="/"><img src="{% static 'images/logo.png' %}" width="120" height="32"></a>
        <div class="container">
          <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
              <li><a href="/" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Главная</font></font></a></li>
              <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQs</font></font></a></li>
              <li><a href="{% url 'aboutPage' %}" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">О нас</font></font></a></li>
            </ul>
            <script>
                $("#searchId").keyup(function(event){
                    if(event.keyCode == 13){
                        $("#searchButId").click();
                    }
                });
            </script>
            <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3">
              <input id ="searchId" type="search" class="form-control form-control-dark" placeholder="Поиск..." aria-label="Поиск" name="q">
                <button id ="searchButId" name="searchBut" formaction="{% url 'searchPage' %}" formtarget="_self" hidden="">Найти</button>
            </form>

            <div class="text-end">
              <button type="button" class="btn btn-outline-light me-2" onclick="location.href='{% url 'avtorizationPage' %}';"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Авторизоваться</font></font></button>
              <button type="button" class="btn btn-warning" onclick="location.href='{% url 'registrationPage' %}';"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Регистрация</font></font></button>
            </div>
          </div>
        </div>
      </header>

    <div id="container">
        <div class="pageContent">

            <!-- Боковое меню с bootstrap -->
            <div class="d-flex flex-column flex-shrink-0 p-3 bg-light" style="width: 280px;">
                <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">
                  <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
                  <span class="fs-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Категории</font></font></span>
                </a>
                <hr>
                <ul class="nav nav-pills flex-column mb-auto">
                    {% for category in categories %}
                        <li>
                            <a href="{% url 'category' category.eng_name %}" class="nav-link {% if category.eng_name == category_name %}active{% else %}link-dark{% endif %}">
                              <svg class="bi me-2" width="16" height="16"><use xlink:href="#{{ category.name }}"></use></svg><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                {{ category.name }}
                            </font></font></a>
                          </li>
                    {% endfor %}
                </ul>
              </div>

            <div class="mainContent">
                <div class="mainContentText">
                    <h1> {% block topictext %}{% endblock %}</h1>
                </div>
                {% block content %}{% endblock %}
                 <div class="productsList">
                     {% block products %} {% endblock %}
                 </div>
                 <div class="pagination_down" style="display: flex;"></div>
                 <script>
                  function $_GET(key) {
                    var p = window.location.search;
                    p = p.match(new RegExp(key + '=([^&=]+)'));
                      return p ? p[1] : false;}
                    page = $_GET('page');
                    if(page == null){page=1;}
                    page=Number(page);
                    var get = '{{page_get}}';
                    get=get.replace(/&amp;/g, '&');
                    var items="{{itemPerPage}}";
                    var count ="{{ total_count }}";
                    var pages_count = Math.ceil(count/items);
                    var articDiv = document.querySelector("div.pagination_down");
                    pages=[];
                    for (var j=1;j<=pages_count;j++){
                        if (j < page && j < 2){pages.push(j);}
                        else if (j == page){pages.push(j);}
                        else if (j > page && j < (page+3)){pages.push(j);}
                        else if (j < page && j > page-3){pages.push(j);}
                        else if (j > page && j > pages_count-1){pages.push(j);} }
                    for (i=0; i<pages.length; i++){
                        var t=pages[i];
                        elem[t] = document.createElement("a");
                        elem[t].href = "?itemPerPage="+items+"&page="+t+"&"+get;
                        articDiv.appendChild(elem[t]);
                        var but = document.createElement('button');
                        if (t==1 && page !== 1)
                            {but.innerHTML="<<";
                             but.title="Первая страница";}
                             else if (t==pages_count && page !== pages_count && page != 1)
                                {but.innerHTML=">>";
                                 but.title="Последняя страница";}
                                 else {but.innerHTML = t;}
                        but.className = "accordion";
                        if (t==page){ but.style.backgroundColor = "#A9A9A9"}
                        elem[t].appendChild(but);  
                    }
                 </script>

            </div>
        </div>
    </div>

    <!-- Подвал с bootstrap -->
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-4 d-flex align-items-center">
          <a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
            <svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
          </a>
          <span class="text-muted"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">© EasyBuild 2021, Inc.</font></font></span>
        </div>

    <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
      <li class="ms-3"><a class="text-muted" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#twitter"></use></svg></a></li>
      <li class="ms-3"><a class="text-muted" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#instagram"></use></svg></a></li>
      <li class="ms-3"><a class="text-muted" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#facebook"></use></svg></a></li>
    </ul>
    </footer>
</body>
</html>
